
<div class="designNavMenu">
	<div class="MenuButton">
		<div class="buttonCancel">
			取消
		</div>
		<div class="buttonSave">
			保存
		</div>
		<div class="buttonConfirm">
			确认
		</div>
	</div>
	<div class="designNavMenuEdit">
		<div class="MenuItem">
			<div class="MenuTitle">图片名称</div>
			<input type="text" maxlength="20" class="input MenuInput picName">
		</div>
		<div class="MenuItem">
			<div class="MenuTitle">图片描述</div>
			<textarea type="text" maxlength="140" class="textarea MenuInput picDescription" rows="3" placeholder="140个字以内"></textarea>
		</div>
		<div class="MenuItem">
			<div class="MenuTitle">图片链接</div>
			<input type="url" class="input MenuInput picLink"  value="http://">
			<div class="MenuTips">点击该图片将会链接到该图片设置的链接地址</div>
		</div>
<!-- 		<div class="MenuItem">
	<div class="MenuTitle">链接信息</div>
	<input type="url" class="input MenuInput" placeholder="http://">
	<div class="MenuTips">此链接地址不可更改</div>
</div> -->
	</div>
	<div class="designNavMenuConfirm">
		<div class="MenuItem">
			<div class="MenuTitle">确认删除？</div>
		</div>
		<div class="MenuText">
			删除后该图片将不可恢复，
		</div>
		<div class="MenuText">
			确认是否删除。
		</div>
	</div>
</div>

<div class="designNavModal">

</div>
<div class="design designIndex">
	<div class="websiteHeader">
		<div class="websiteTitle">
			<div class="websiteTitleImg">
				
			</div>
			<div class="websiteTitleArea">
				<div class="websiteTitle1St"></div>
				<div class="websiteTitle2nd">
					<div class="websiteSubTitle">还未添加网站简介</div>
				</div>
			</div>
		</div>
		<div class="columnRight">
			<ul>
				<li><a href="" class="rightNavIndex active">首页</a></li>
				<volist name="column" id="vo">
					<if condition="$vo.visible eq 1 AND $vo.status eq 1">
						<li><a class="columnLink" order="{$i}" typename="{$vo.type}" name="{$vo.id}" href="">{$vo.name}</a></li>
					<else/>
					</if>
				</volist>
			</ul>
		</div>
	</div>
	<div id="index" class="vp_body main_page">
		<div class="vp_btn_group">
			<button id="pre" class="vp_pre">
			<!-- <svg width="20" height="70" version="1.1" xmlns="http://www.w3.org/2000/svg">
					<polyline points="20,0 0,35 20,70"/>
				</svg> -->
				</button>
				<button id="next" class="vp_next">
				<!-- <svg width="20" height="70" version="1.1" xmlns="http://www.w3.org/2000/svg">
						<polyline points="0,0 20,35 0,70"/>
					</svg> -->
					</button>
				</div>
				<div id="item_group" class="vp_item_group">
					<!-- You can add any number of groups of items here -->
					<volist name="list" id="vo">
					<div class="vp_item">
						<notempty name="vo['link']">
						<a class="vp_link" href="{$vo.link}" target="_blank">
							</notempty>
							<div class="vp_img" name="{$vo.id}" style="background-image: url({$vo.path});">
								
							</div>
							<notempty name="vo['link']">
						</a>
						</notempty>
						<div class="vp_words">
							<h1 class="vp_title">
							{$vo.name}
							</h1>
							<p class="vp_desc">
								{$vo.description}
							</p>
						</div>
					</div>
					</volist>
					<!-- 		<volist name="list" id="vo">
					<div class="vp_item">
						<notempty name="vo['link']">
						<a href="{$vo.link}" target="_blank">
								</notempty>
								<img class="vp_img"  src="">
								<notempty name="vo['link']">
						</a>
						</notempty>
						
						<div class="vp_words">
								<h1>{$vo.name}</h1>
								<p>{$vo.description}</p>
						</div>
					</div>
					</volist> -->
					
					</div> <!-- vp_item_group -->
					<div id="vp_item_btn_group" class="vp_item_btn_group"></div>
					<div id="show_info_btn" class="show_info_btn btn_towhite">
						<svg width="30" height="30" version="1.1" xmlns="http://www.w3.org/2000/svg">
							<polyline points="5,20 15,10 25,20"/>
							</svg>
						</div>
						</div> <!-- vp_body -->
<!-- 	<div id="vp_body" class="vp_body main_page">
	<div class="vp_btn_group">
		<button id="pre" class="vp_pre">
		<svg width="20" height="70" version="1.1" xmlns="http://www.w3.org/2000/svg">
			<polyline points="20,0 0,35 20,70"/>
			</svg>
			</button>
			<button id="next" class="vp_next">
			<svg width="20" height="70" version="1.1" xmlns="http://www.w3.org/2000/svg">
				<polyline points="0,0 20,35 0,70"/>
				</svg>
				</button>
			</div>
			<div class="vp_item_group">
				You can add any number of groups of items here
				<volist name="list" id="vo">
				<div class="vp_item">
					<notempty name="vo['link']">
						<a href="{$vo.link}" target="_blank">
					</notempty>
						<img class="vp_img" name="{$vo.id}" src="{$vo.path}">
					<notempty name="vo['link']">
						</a>
					</notempty>
					
					<div class="vp_words">
						<h1>{$vo.name}</h1>
						<p>{$vo.description}</p>
					</div>
				</div>
				</volist>
				</div> vp_item_group
				<div id="vp_item_btn_group" class="vp_item_btn_group"></div>
				<div id="show_info_btn" class="show_info_btn btn_towhite">
					<svg width="30" height="30" version="1.1" xmlns="http://www.w3.org/2000/svg">
						<polyline points="5,20 15,10 25,20"/>
						</svg>
					</div>
				</div> -->
					<!-- vp_body -->
					<!-- 	<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
						Indicators
						<ol class="carousel-indicators">
								<volist name="list" id="vo" >
									<if condition="$key eq 0">
										<li data-target="#carousel-example-generic" class="active" data-slide-to="{$key}" ></li>
										<else />
										<li data-target="#carousel-example-generic" data-slide-to="{$key}" ></li>
									</if>
								</volist>
						</ol>
						Wrapper for slides
						<div class="carousel-inner" role="listbox">
								<volist name="list" id="vo">
									<if condition="$key eq 0">
										<div class="item active">
										<else />
											<div class="item">
											</if>
													<img class="img-responsive carouselImg" name="{$vo.id}" src="{$vo.path}">
													<div class="carousel-caption">
															
													</div>
											</div>
									</volist>
							</div>
							Controls
							<a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
									<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
									<span class="sr-only">Previous</span>
							</a>
							<a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
									<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
									<span class="sr-only">Next</span>
							</a>
						</div> -->
					</div>

<link rel="stylesheet" type="text/css" href="__CSS__/carousel.css">
<script type="text/javascript" src="__JS__/ModalResetting.js"></script>
<script type="text/javascript" src="__JS__/carousel.js"></script>

<script type="text/javascript">
	$(".designIndex").css('height', height - 180 + "px");
	$(".carousel-inner").css('max-height', height - 210 + "px");
	$(".designNavModal").css('height', height - 120 + "px");
	$(".designNavModal").css('width', width - 185 + "px");
	$(".designNavMenu").css('height', height - 120 + "px");
	$(".vp_body").css('height', height - 220 + "px");
	/*获取当前网站信息*/
    $.post('/Design/getCurWebsiteInfo', function(data) {
    	if (data[0]["logo_path"]) {
    		$(".websiteTitleImg").css('background-image', 'url(' + data[0]["logo_path"] +')');
    	}
    	if (data[0]["name"]) {
    		$(".websiteTitle1St").text(data[0]["name"]);
    	}
    	if (data[0]["sub_title"]) {
    		$(".websiteSubTitle").text(data[0]["sub_title"]);
    	}
    });
    /*右侧导航栏*/
    $(".rightNavIndex").click(function() {
	    $(".content").load('designIndex.html', function() {
	        $(".designIndex").fadeIn(400)
	    });
	    return false;
    });
    /*删除图片确认*/
    $(".buttonConfirm").click(function() {
    	$.post('/Design/deleteIndexOnePic', {pid: imgid}, 
    	function(data) {
    		if (data) {
    			$.snackbar({content: '删除图片成功'});
    		}
    		else {
    			$.snackbar({content: '删除图片失败'});
    		}
    	});
		setTimeout(function() {
			$(".content").load('designIndex.html' , function () {
					$(".designIndex").fadeIn(400)
				});
		    $(".side").load('designNavIndex.html', function() {
                $(".designNavIndex").animate({
                    left: '0',
                }, 0);
                $(".designNavIndex").css('height', height - 120 + "px");
            });
		}, 300);
    });
    /*url正则验校*/
	function IsURL(str_url) {
		var strRegex = /^((https|http|ftp|rtsp|mms)?:\/\/)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]$)|([0-9a-z_!~*'()-]+\.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z]\.[a-z]{2,6})(:[0-9]{1,4})?((\/?)|(\/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+\/?)$/;
         var re = new RegExp(strRegex);
         //re.test()
         if (re.test(str_url)) {
             return (true);
         } else {
             return (false);
         }
     };
    /*保存图片信息确认*/
    $(".buttonSave").click(function() {
		var picName = $(".picName").val();
		var picDescription = $(".picDescription").val();
		var picLink = $(".picLink").val();
		var flag = IsURL(picLink);
		if (flag == true || picLink == "http://") {
			if(picLink == "http://"){
				picLink = "";
			}
	        $.post('/Design/addIndexItem', {
	            pid: pic_id,
	            gid: cur_id,
	            name: picName,
	            description: picDescription,
	            link: picLink
	        }, function(data) {
	            if (data) {
	                $.snackbar({
	                    content: '图片设置成功'
	                });
	            } else {
	                $.snackbar({
	                    content: '图片设置失败'
	                });
	            }
	        });
	        setTimeout(function() {
	            $(".content").load('designIndex.html', function() {
	                $(".designIndex").fadeIn(400)
	            });
	        }, 300);
		}
		else {
			$(".picLink").val("");
	        $.snackbar({
	            content: '图片链接格式不正确，请重新输入'
	        });
		}

	});
    /*点击遮罩返回*/
    $(".designNavModal").click(function() {
		$(".designNavModal").fadeOut(400);
		$(".designNavMenu").animate({
		        left: '-400px',
		    }, 300);
    });
	/*点击右导航栏进行跳转*/
	$(".columnLink").click(function() {
		cur_id = $(this).attr('name');
		//cur_order = $(this).attr('order');
		if ($(this).attr('typename') == 1) {
	        $(".content").load('designGallery.html?cid=' + cur_id, function() {
	            $(".designGallery").fadeIn(400)
	        });
		}
		else {
			$(".content").load('designBlog.html?cid=' + cur_id, 
				function() {
	            $(".designBlog").fadeIn(400)
	        });
		}
		setTimeout(function() {
			$(".sidebar").load("designNav.html", function() {
				$(".designNav").fadeIn();
				$(".sideNav").animate({
					left: '0px'
				},0);
			});
			//$( "#accordion" ).accordion( "option", "active", cur_order );
		}, 300);
		return false;
	});
	/*开启轮播图*/
	setTimeout(function() {
	    $().viewpager({
			auto: true,
			speed: 5000
	    });
	}, 100);



</script>

